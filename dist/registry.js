Object.defineProperty(exports, "__esModule", { value: true });
var dom_1 = require("./dom");
var constants_1 = require("./constants");
var registry = new Map();
var isBrowser = typeof window !== 'undefined' && !!window.document;
global[constants_1.ImportID] = global[constants_1.ImportID] || { registry: registry };
function register(moduleID, css) {
    if (!global[constants_1.ImportID].registry.has(moduleID) || global[constants_1.ImportID].registry.get(moduleID) !== css) {
        global[constants_1.ImportID].registry.set(moduleID, css);
        if (isBrowser)
            dom_1.default(moduleID, css);
    } // else: content is registered or unchanged --> noop
    console.log('isServer', !isBrowser, global[constants_1.ImportID].registry.size, process.pid);
}
exports.register = register;
function get() {
    console.log('2isServer', !isBrowser, global[constants_1.ImportID].registry.size, process.pid);
    return global[constants_1.ImportID].registry;
}
exports.get = get;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0cnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcmVnaXN0cnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLDZCQUFpQztBQUNqQyx5Q0FBdUM7QUFDdkMsSUFBTSxRQUFRLEdBQWlDLElBQUksR0FBRyxFQUEyQixDQUFDO0FBRWxGLElBQU0sU0FBUyxHQUFZLE9BQU8sTUFBTSxLQUFLLFdBQVcsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQztBQUU3RSxNQUFjLENBQUMsb0JBQVEsQ0FBQyxHQUFJLE1BQWMsQ0FBQyxvQkFBUSxDQUFDLElBQUksRUFBRSxRQUFRLFVBQUEsRUFBRSxDQUFDO0FBR3RFLGtCQUF5QixRQUF5QixFQUFFLEdBQVc7SUFDM0QsRUFBRSxDQUFDLENBQUMsQ0FBRSxNQUFjLENBQUMsb0JBQVEsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLElBQUssTUFBYyxDQUFDLG9CQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDL0csTUFBYyxDQUFDLG9CQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUN0RCxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUM7WUFBQyxhQUFZLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQy9DLENBQUMsQ0FBQyxvREFBb0Q7SUFDdEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxTQUFTLEVBQUcsTUFBYyxDQUFDLG9CQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUM5RixDQUFDO0FBTkQsNEJBTUM7QUFFRDtJQUNJLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsU0FBUyxFQUFHLE1BQWMsQ0FBQyxvQkFBUSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDM0YsTUFBTSxDQUFFLE1BQWMsQ0FBQyxvQkFBUSxDQUFDLENBQUMsUUFBUSxDQUFDO0FBQzlDLENBQUM7QUFIRCxrQkFHQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB1cGRhdGVTdHlsZXMgZnJvbSAnLi9kb20nO1xuaW1wb3J0IHsgSW1wb3J0SUQgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5jb25zdCByZWdpc3RyeTogTWFwPG51bWJlciB8IHN0cmluZywgc3RyaW5nPiA9IG5ldyBNYXA8bnVtYmVyIHwgc3RyaW5nLCBzdHJpbmc+KCk7XG5cbmNvbnN0IGlzQnJvd3NlcjogYm9vbGVhbiA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICEhd2luZG93LmRvY3VtZW50O1xuXG4oZ2xvYmFsIGFzIGFueSlbSW1wb3J0SURdID0gKGdsb2JhbCBhcyBhbnkpW0ltcG9ydElEXSB8fCB7IHJlZ2lzdHJ5IH07XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyKG1vZHVsZUlEOiBudW1iZXIgfCBzdHJpbmcsIGNzczogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCEoZ2xvYmFsIGFzIGFueSlbSW1wb3J0SURdLnJlZ2lzdHJ5Lmhhcyhtb2R1bGVJRCkgfHwgKGdsb2JhbCBhcyBhbnkpW0ltcG9ydElEXS5yZWdpc3RyeS5nZXQobW9kdWxlSUQpICE9PSBjc3MpIHtcbiAgICAgICAgKGdsb2JhbCBhcyBhbnkpW0ltcG9ydElEXS5yZWdpc3RyeS5zZXQobW9kdWxlSUQsIGNzcyk7XG4gICAgICAgIGlmIChpc0Jyb3dzZXIpIHVwZGF0ZVN0eWxlcyhtb2R1bGVJRCwgY3NzKTtcbiAgICB9IC8vIGVsc2U6IGNvbnRlbnQgaXMgcmVnaXN0ZXJlZCBvciB1bmNoYW5nZWQgLS0+IG5vb3BcbiAgICBjb25zb2xlLmxvZygnaXNTZXJ2ZXInLCAhaXNCcm93c2VyLCAoZ2xvYmFsIGFzIGFueSlbSW1wb3J0SURdLnJlZ2lzdHJ5LnNpemUsIHByb2Nlc3MucGlkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldCgpOiBNYXA8bnVtYmVyIHwgc3RyaW5nLCBzdHJpbmc+IHtcbiAgICBjb25zb2xlLmxvZygnMmlzU2VydmVyJywgIWlzQnJvd3NlciwgKGdsb2JhbCBhcyBhbnkpW0ltcG9ydElEXS5yZWdpc3RyeS5zaXplLCBwcm9jZXNzLnBpZCk7XG4gICAgcmV0dXJuIChnbG9iYWwgYXMgYW55KVtJbXBvcnRJRF0ucmVnaXN0cnk7XG59XG4iXX0=